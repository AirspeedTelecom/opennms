<blueprint xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="
    http://www.osgi.org/xmlns/blueprint/v1.0.0 http://www.osgi.org/xmlns/blueprint/v1.0.0/blueprint.xsd
">

	<reference id="ncsComponentRepository" interface="org.opennms.netmgt.model.ncs.NCSComponentRepository" availability="mandatory" />
	<reference id="nodeDao" interface="org.opennms.netmgt.dao.NodeDao" availability="mandatory" />

	<command-bundle xmlns="http://karaf.apache.org/xmlns/shell/v1.0.0">
		<command name="ncs/listcomponents">
			<action class="org.opennms.features.topology.plugins.ncs.ComponentCommand" />
		</command>
	</command-bundle>

	<bean id="ncsServiceContainer" class="org.opennms.features.topology.plugins.ncs.NCSServiceContainer" scope="prototype">
		<description>This bean exposes the NCS object model as a hierarchical container.</description>
		<argument ref="ncsComponentRepository" />
	</bean>

	<bean id="ncsFilterableContainer" class="org.opennms.features.topology.api.support.FilterableHierarchicalContainer" scope="prototype">
		<argument ref="ncsServiceContainer" />
	</bean>

	<bean id="ncsServiceTree" class="org.opennms.features.topology.plugins.ncs.NCSSelectionTree" scope="prototype">
		<description>This selection tree is a UI component for the NCS tree.</description>
		<argument ref="ncsFilterableContainer" />
		<property name="ncsComponentRepository" ref="ncsComponentRepository" />
		<property name="nodeDao" ref="nodeDao" />
	</bean>

	<bean id="ncsServiceTreeFactory" class="org.opennms.features.topology.api.support.SelectionTreeFactory">
		<description>This factory will access the blueprint container to create new selection trees.</description>
		<!-- Blueprint container bean -->
		<argument ref="blueprintContainer"/>
		<!-- Bean id of the prototype selection tree -->
		<argument value="ncsServiceTree"/>
		<property name="title" value="Services"/>
	</bean>

	<service interface="org.opennms.features.topology.api.IViewContribution" ref="ncsServiceTreeFactory">
		<description>Bind the selection tree UI factory as an IViewContribution service.</description>
		<service-properties>
			<entry key="location" value="left"/>
		</service-properties>
	</service>

<!--
	<service interface="org.opennms.features.topology.api.topo.EdgeProvider" ref="ncsServiceTree">
		<description>Also bind the selection tree UI as an EdgeProvider for the topology.</description>
	</service>
-->
</blueprint>
